<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap" rel="stylesheet" />
  <title>–ü—Ä–æ–ó–∞—Ö–∏—Å—Ç - –º–∞–≥–∞–∑–∏–Ω —Å–∏—Å—Ç–µ–º –±–µ–∑–ø–µ–∫–∏</title>
  <style>
    :root {
      --accent: #007bff;
      --accent-dark: #0056b3;
      --text-dark: #333;
      --gray: #808080;
      --bg: #f4f4f4;
      --card-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    * { box-sizing: border-box; }
    body {
      font-family: 'Open Sans', sans-serif;
      margin: 0;
      background-color: var(--bg);
      color: var(--text-dark);
      overflow-x: hidden;
    }
    header {
      position: fixed;
      inset: 0 0 auto 0;
      height: 65px;
      background: linear-gradient(to right, rgba(7,7,7,0.95), rgba(148,148,148,0.95));
      color: #fff;
      padding: 0 12px;
      display: flex;
      align-items: center;
      z-index: 1000;
    }
    header .logo svg { height: 65px; width: auto; }
    main { padding-top: 80px; }
    .toast {
      position: fixed;
      top: 45%; left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.4);
      color: #fff;
      padding: 8px 12px;
      border-radius: 5px;
      white-space: nowrap;
      visibility: hidden;
      opacity: 0;
      transition: opacity .5s;
      z-index: 9999;
    }
    .toast.show { visibility: visible; opacity: 1; }
    .cart {
      position: fixed;
      top: 14px; right: 10px;
      background: #333; color: #fff;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      z-index: 1100;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 16px;
    }
    .cart-content {
      position: fixed;
      right: 20px; top: 100px;
      width: 350px;
      background: rgba(255,255,255,0.95);
      padding: 20px;
      border-radius: 8px;
      box-shadow: var(--card-shadow);
      display: none;
      z-index: 1100;
    }
    #cart-items { max-height: 300px; overflow-y: auto; }
    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    .quantity-control { display: flex; align-items: center; gap: 5px; }
    .quantity-btn {
      width: 30px; height: 30px;
      border: none; border-radius: 5px;
      background: var(--accent); color: #fff;
      font-size: 18px;
      cursor: pointer;
      transition: background .3s;
    }
    .quantity-btn:hover { background: var(--accent-dark); }
    .category-buttons {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 15px;
      padding: 120px 20px 40px;
      background-image: url('images/fon_for_category.png');
      background-size: cover;
      background-position: center;
    }
    .category-card {
      position: relative;
      flex: 1 1 calc(20% - 20px);
      max-width: calc(20% - 20px);
      border-radius: 10px;
      overflow: hidden;
      box-shadow: var(--card-shadow);
      cursor: pointer;
      transition: transform .3s;
    }
    .category-card:hover { transform: scale(1.05); }
    .category-card img { width: 100%; height: 100%; object-fit: cover; display: block; }
    .category-card span {
      position: absolute;
      inset: auto 0 0;
      padding: 10px;
      text-align: center;
      font-weight: bold;
      color: #bbb;
      font-size: .85em;
    }
    .contacts-block {
      display: flex;
      flex-direction: column;
      font-weight: bold;
      color: var(--gray);
    }
    .contact-link {
      color: var(--gray);
      text-decoration: none;
      margin-bottom: 8px;
      transition: color .3s, transform .2s;
    }
    .contact-link:hover { color: var(--accent); transform: translateX(1px); }
    .products {
      display: none;
      padding: 80px 20px 60px;
    }
    .products.active { display: block; animation: fadeIn .4s ease-in-out; }
    .products h2 { text-align: center; margin-bottom: 40px; }
    .products-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      padding: 0 10px;
    }
    .product-item {
      background: #fff;
      box-shadow: var(--card-shadow);
      padding: 15px;
      flex: 0 1 230px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      transition: transform .2s;
      cursor: pointer;
    }
    .product-item:hover { transform: scale(1.03); }
    .product-item img { width: 100%; height: auto; object-fit: cover; }
    .product-item h3 {
      font-size: 1em;
      margin: 10px 0 5px;
      min-height: 48px;
    }
    .product-item p { margin: 5px 0; flex-grow: 1; }
    .product-price {
      font-size: 1.2em;
      color: red;
      font-weight: bold;
      margin: 10px 0 5px;
    }
    .btn {
      display: inline-block;
      padding: 10px 20px;
      background: var(--accent);
      color: #fff;
      border-radius: 5px;
      cursor: pointer;
      transition: transform .3s ease, background .3s ease;
    }
    .btn:hover { background: var(--accent-dark); }
    footer {
      background: #333;
      color: #fff;
      text-align: center;
      padding: 8px;
      font-size: .85em;
    }
    footer .black { color: var(--gray); }
    .highlight-product { outline: 3px solid #ff4747; border-radius: 8px; transition: outline .2s; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @media (max-width: 1024px) {
      .category-card { flex: 1 1 calc(33% - 20px); max-width: calc(33% - 20px); }
    }
    @media (max-width: 768px) {
      .cart { font-size: .85em; padding: 8px; }
      .cart-content {
        width: 85%;
        max-width: 400px;
        inset: 70px auto auto 0;
        margin: 0 auto;
      }
      .category-buttons { padding: 95px 10px 30px; gap: 10px; }
      .category-card { flex: 1 1 calc(50% - 15px); max-width: calc(50% - 15px); }
      .products { padding: 70px 10px 60px; }
      .products-container {
        flex-direction: column;
        align-items: center;
        gap: 20px;
        padding: 0 5px;
      }
      .product-item { width: 100%; max-width: 400px; }
      footer { font-size: .8em; }
    }
    @media (max-width: 900px) and (orientation: landscape) {
      .category-buttons { padding-top: 80px; }
    }
    .hidden { display: none !important; }
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <svg xmlns="http://www.w3.org/2000/svg" width="220" height="70" viewBox="0 0 600 200">
        <text x="15" y="100" font-family="Open Sans, sans-serif" font-weight="bold" font-size="74" fill="#800000">–ü–†–û</text>
        <text x="172" y="100" font-family="Open Sans, sans-serif" font-weight="bold" font-size="74" fill="#808080">–ó–ê–•–ò–°–¢</text>
        <text x="15" y="160" font-family="Arial, sans-serif" font-weight="bold" font-size="29" fill="#bbbbbb">–Ü–ù–¢–ï–†–ù–ï–¢-–ú–ê–ì–ê–ó–ò–ù –°–ò–°–¢–ï–ú –ë–ï–ó–ü–ï–ö–ò</text>
        <line x1="483" y1="65" x2="523" y2="48" stroke="#800000" stroke-width="10"/>
        <line x1="523" y1="48" x2="563" y2="65" stroke="#800000" stroke-width="10"/>
        <line x1="493" y1="70" x2="493" y2="100" stroke="#808080" stroke-width="10"/>
        <line x1="553" y1="70" x2="553" y2="100" stroke="#808080" stroke-width="10"/>
      </svg>
    </div>
  </header>

  <div id="toast" class="toast"></div>

  <div class="cart" onclick="toggleCart()">üõí –ö–æ—à–∏–∫ (<span id="cart-count">0</span>)</div>
  <div class="cart-content" id="cart-content">
    <h2>–ú—ñ–π –∫–æ—à–∏–∫</h2>
    <div id="cart-items"></div>
    <p class="total-price">–°—É–º–∞: <span id="total-price">0</span> –≥—Ä–Ω</p>
    <p id="stock-warning" style="color:red;font-weight:bold;"></p>
    <div class="button-row" style="display:flex;justify-content:space-between;margin-top:10px;gap:10px;">
      <a href="checkout.html" class="checkout-button btn" style="background:#4CAF50;min-width:120px;text-align:center;">–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</a>
      <button class="cancel-button btn" style="background:#f35363;min-width:120px;" onclick="clearCart();toggleCart()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
    </div>
  </div>

  <!-- –∑–≤—É–∫–∏ ‚Äî –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
  <audio id="hover-sound" src="hover_1.mp3" preload="auto"></audio>

  <main>
    <div id="categories" class="category-buttons">
      <div class="category-card" onclick="toggleCategory('indoor')"><img src="images/indoor.png" alt="–í–Ω—É—Ç—Ä—ñ—à–Ω—ñ –∫–∞–º–µ—Ä–∏"><span>–í–Ω—É—Ç—Ä—ñ—à–Ω—ñ –∫–∞–º–µ—Ä–∏</span></div>
      <div class="category-card" onclick="toggleCategory('outdoor')"><img src="images/outdoor.png" alt="–ó–æ–≤–Ω—ñ—à–Ω—ñ –∫–∞–º–µ—Ä–∏"><span>–ó–æ–≤–Ω—ñ—à–Ω—ñ –∫–∞–º–µ—Ä–∏</span></div>
      <div class="category-card" onclick="toggleCategory('outdoor_4G')"><img src="images/outdoor_4G.png" alt="–ó–æ–≤–Ω—ñ—à–Ω—ñ 4G –∫–∞–º–µ—Ä–∏"><span>–ó–æ–≤–Ω—ñ—à–Ω—ñ 4G –∫–∞–º–µ—Ä–∏</span></div>
      <div class="category-card" onclick="toggleCategory('alarm')"><img src="images/alarm.png" alt="–û—Ö–æ—Ä–æ–Ω–Ω–∞ —Å–∏–≥–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è"><span>–ö–æ–º–ø–ª–µ–∫—Ç–∏ —Å–∏–≥–Ω–∞–ª—ñ–∑–∞—Ü—ñ—ó</span></div>
      <div class="category-card" onclick="toggleCategory('hub')"><img src="images/hub.png" alt="–•–∞–±–∏"><span>–•–∞–±–∏</span></div>
      <div class="category-card" onclick="toggleCategory('protect')"><img src="images/protect.png" alt="–î–∞—Ç—á–∏–∫–∏ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ —Å–∏—Ä–µ–Ω–∏"><span>–î–∞—Ç—á–∏–∫–∏, –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏, —Å–∏—Ä–µ–Ω–∏</span></div>
      <div class="category-card" onclick="toggleCategory('waterstop')"><img src="images/waterstop.png" alt="–ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ—Ç–æ–ø—É"><span>–ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ—Ç–æ–ø—É</span></div>
      <div class="category-card" onclick="toggleCategory('fire')"><img src="images/fire.png" alt="–ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ–∂–µ–∂—ñ"><span>–ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ–∂–µ–∂—ñ</span></div>
      <div class="category-card" onclick="toggleCategory('microSD')"><img src="images/microSD.png" alt="microSD"><span>–ö–∞—Ä—Ç–∏ –ø–∞–º'—è—Ç—ñ</span></div>
      <a href="tel:+380935016040" class="category-card"><img src="images/help.png" alt="Help"><span></span></a>
      <div class="contacts-block">
        <a href="tel:+380935016040" class="contact-link">üìû (093) 501-60-40</a>
        <a href="mailto:prozakhyst@ukr.net" class="contact-link">üìß prozakhyst@ukr.net</a>
      </div>
    </div>

    <!-- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∫–∞–º–µ—Ä—ã -->
    <section id="indoor" class="products">
      <h2>–í–Ω—É—Ç—Ä—ñ—à–Ω—ñ –≤—ñ–¥–µ–æ–∫–∞–º–µ—Ä–∏</h2>
      <div class="products-container">
        <!-- ... (–≤—Å–µ —Ç–æ–≤–∞—Ä—ã indoor –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–∞) ... -->
        <div class="product-item" onclick="openProductDetails('details_indoor_2(IPC-C32EP).html')">
          <img src="images/IPC-C22EP-A.png" alt="–í—ñ–¥–µ–æ–∫–∞–º–µ—Ä–∞ 2">
          <h3>–ö–æ–º–ø–∞–∫—Ç–Ω–∞ –∫–∞–º–µ—Ä–∞ IMOU IPC-C32EP</h3>
          <p>Wi-Fi –∫–∞–º–µ—Ä–∞ —Ä–æ–∑–¥—ñ–ª—å–Ω–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å 3–ú–ü –∑ –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–º –∞—É–¥—ñ–æ–∑–≤'—è–∑–∫–æ–º, –∫—É—Ç 112¬∞</p>
          <p class="product-price">1548.00 –≥—Ä–Ω</p>
          <button class="btn" onclick="addToCart(event,{id:'IPC-C32EP',name:'–ö–∞–º–µ—Ä–∞ IPC-C32EP',price:1548,image:'images/IPC-C22EP-A.png'})">–î–æ–¥–∞—Ç–∏ —É –∫–æ—à–∏–∫</button>
        </div>
        <!-- –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ indoor... -->
        <!-- (–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –≤—Å–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏; –æ–ø—É—â–µ–Ω—ã –∑–¥–µ—Å—å –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏) -->
      </div>
    </section>

    <!-- –ó–æ–≤–Ω—ñ—à–Ω—ñ, 4G, Alarm, Hub, Protect, Waterstop, microSD -->
    <!-- –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ: –≤—Å—Ç–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ -->
    <!-- ... -->
  </main>

  <footer>
    <p>&copy; 2024-2025 <span class="black">–ü–†–û–ó–ê“≤–ò–°–¢.</span> –í—Å—ñ –ø—Ä–∞–≤–∞ –∑–∞—Ö–∏—â–µ–Ω—ñ.</p>
  </footer>

  <audio id="hover-sound" src="hover.mp3" preload="auto"></audio>
  <audio id="back-sound" src="hover_2.mp3" preload="auto"></audio>

  <script>
  (() => {
    const safeStorage = {
      get(key) { try { return JSON.parse(localStorage.getItem(key)) || null; } catch { return null; } },
      set(key, value) { try { localStorage.setItem(key, JSON.stringify(value)); } catch {} },
      remove(key) { try { localStorage.removeItem(key); } catch {} }
    };

    let cart = safeStorage.get('cart') || [];

    function renderCartItem(item) {
      const container = document.createElement('div');
      container.className = 'cart-item';

      const img = document.createElement('img');
      img.src = item.image;
      img.alt = item.name;
      img.style.width = '30px';
      img.style.height = 'auto';
      img.style.marginRight = '5px';

      const title = document.createElement('span');
      title.textContent = `${item.name} - ${item.price} –≥—Ä–Ω`;

      const qtyControl = document.createElement('div');
      qtyControl.className = 'quantity-control';

      const decBtn = document.createElement('button');
      decBtn.className = 'quantity-btn';
      decBtn.textContent = '-';
      decBtn.onclick = (ev) => decreaseQuantity(item.id, ev);

      const qty = document.createElement('span');
      qty.className = 'quantity';
      qty.textContent = item.quantity;

      const incBtn = document.createElement('button');
      incBtn.className = 'quantity-btn';
      incBtn.textContent = '+';
      incBtn.onclick = (ev) => increaseQuantity(item.id, ev);

      qtyControl.append(decBtn, qty, incBtn);
      container.append(img, title, qtyControl);
      return container;
    }

    function updateCart() {
      const cartItemsEl = document.getElementById('cart-items');
      const totalPriceEl = document.getElementById('total-price');
      const cartCountEl = document.getElementById('cart-count');
      const stockWarningEl = document.getElementById('stock-warning');
      if (!cartItemsEl || !totalPriceEl || !cartCountEl || !stockWarningEl) return;

      cartItemsEl.innerHTML = '';
      let total = 0;
      let quantity = 0;

      cart.forEach(item => {
        total += item.price * item.quantity;
        quantity += item.quantity;
        cartItemsEl.appendChild(renderCartItem(item));
      });

      totalPriceEl.textContent = total.toFixed(2);
      cartCountEl.textContent = quantity;
      stockWarningEl.textContent = quantity > 10 ? '–£–≤–∞–≥–∞! –û–±–º–µ–∂–µ–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–æ–≤–∞—Ä—É. –ù–∞—è–≤–Ω—ñ—Å—Ç—å —É—Ç–æ—á–Ω—é–π—Ç–µ' : '';
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      if (!toast) return;
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    window.addToCart = function(event, item) {
      event?.stopPropagation?.();
      const existing = cart.find(ci => ci.id === item.id);
      if (existing) existing.quantity += 1;
      else cart.push({ ...item, quantity: 1 });

      safeStorage.set('cart', cart);
      updateCart();
      showToast(`${item.name} –¥–æ–¥–∞–Ω–æ –¥–æ –∫–æ—à–∏–∫–∞!`);
    };

    window.addToCartFromProductPage = window.addToCart;

    window.increaseQuantity = function(id, event) {
      event.stopPropagation();
      const item = cart.find(i => i.id === id);
      if (item) {
        item.quantity += 1;
        safeStorage.set('cart', cart);
        updateCart();
      }
    };

    window.decreaseQuantity = function(id, event) {
      event.stopPropagation();
      const item = cart.find(i => i.id === id);
      if (!item) return;
      if (item.quantity > 1) item.quantity -= 1;
      else cart = cart.filter(i => i.id !== id);
      safeStorage.set('cart', cart);
      updateCart();
    };

    window.clearCart = function() {
      cart = [];
      safeStorage.remove('cart');
      updateCart();
      showToast('–ö–æ—à–∏–∫ –æ—á–∏—â–µ–Ω–æ');
    };

    window.toggleCart = function() {
      const panel = document.getElementById('cart-content');
      if (!panel) return;
      panel.style.display = (panel.style.display === 'block') ? 'none' : 'block';
    };

    document.addEventListener('click', (ev) => {
      const panel = document.getElementById('cart-content');
      const cartBtn = document.querySelector('.cart');
      if (!panel || !cartBtn) return;
      if (!panel.contains(ev.target) && !cartBtn.contains(ev.target)) {
        panel.style.display = 'none';
      }
    });

    let currentCategory = null;
    const categorySections = Array.from(document.querySelectorAll('.products'));
    const categoriesBlock = document.getElementById('categories');

    function showCategoriesLanding() {
      categorySections.forEach(section => section.classList.remove('active'));
      categoriesBlock?.classList.remove('hidden');
      currentCategory = null;
      safeStorage.remove('lastCategory');
    }

    window.toggleCategory = function(catId, push = true) {
      const target = document.getElementById(catId);
      if (!target) return;

      categorySections.forEach(section => section.classList.remove('active'));
      target.classList.add('active');
      categoriesBlock?.classList.add('hidden');

      currentCategory = catId;
      if (push) {
        history.pushState({ category: catId }, '', '#' + catId);
        setTimeout(() => window.scrollTo({ top: 0, behavior: 'smooth' }), 100);
      }
      safeStorage.set('lastCategory', catId);
      currentIndex = categorySections.indexOf(target);
    };

    function extractProductIdFromUrl(url = '') {
      const match = url.match(/\(([^)]+)\)/);
      if (match) return match[1];
      const filename = url.split('/').pop()?.split(/[?#]/)[0] || '';
      return filename.replace(/\.[^.]+$/, '') || filename;
    }

    window.openProductDetails = function(pageUrl) {
      const prodId = extractProductIdFromUrl(pageUrl);
      if (currentCategory) safeStorage.set('lastCategory', currentCategory);
      if (prodId) safeStorage.set('lastProductId', prodId);
      safeStorage.set('lastScroll', String(window.scrollY || 0));
      window.location.href = pageUrl;
    };

    function handleState(state) {
      if (!state || !state.category) {
        showCategoriesLanding();
        return;
      }
      toggleCategory(state.category, false);
    }

    const backSound = document.getElementById('back-sound');
    if (backSound) backSound.volume = 0.35;

    window.addEventListener('popstate', (e) => {
      handleState(e.state);
      if (backSound) {
        backSound.currentTime = 0;
        backSound.play().catch(() => {});
      }
    });

    window.addEventListener('pageshow', () => {
      const savedCategory = safeStorage.get('lastCategory');
      if (savedCategory && document.getElementById(savedCategory)) {
        toggleCategory(savedCategory, false);
      } else {
        showCategoriesLanding();
      }
      cart = safeStorage.get('cart') || [];
      updateCart();
    });

    const hoverSound = document.getElementById('hover-sound');
    if (hoverSound) {
      hoverSound.volume = 0.4;
      document.querySelectorAll('.category-card').forEach(card => {
        card.addEventListener('mouseenter', () => {
          hoverSound.currentTime = 0;
          hoverSound.play().catch(() => {});
        });
      });
    }

    let touchStartX = 0;
    let touchEndX = 0;
    let currentIndex = categorySections.findIndex(section => section.classList.contains('active'));
    if (currentIndex < 0) currentIndex = 0;

    function showCategoryByIndex(index) {
      if (index < 0 || index >= categorySections.length) return;
      const section = categorySections[index];
      if (section && section.id) toggleCategory(section.id);
    }

    function handleSwipe() {
      const diff = touchEndX - touchStartX;
      if (Math.abs(diff) < 50) return;
      if (diff < 0) showCategoryByIndex(currentIndex + 1);
      else showCategoryByIndex(currentIndex - 1);
    }

    document.addEventListener('touchstart', (e) => { touchStartX = e.touches[0].clientX; });
    document.addEventListener('touchend', (e) => {
      touchEndX = e.changedTouches[0].clientX;
      handleSwipe();
    });

    updateCart();
  })();
  </script>
</body>
</html>
